# Neural Machine Translation (from German to English)

## 1. Introduction

In this assignment, initially we are given a `seq2seq` neural machine translation (NMT) network with broken attention mechanism.

Our tasks are:

- Correctly implement attention mechanism for the `seq2seq` network;
- Implement `beam search` as a better decoding strategy;
- Implement any techniques to further improve the `BLEU` scores.

Please refer to [neuralmt.ipynb](neuralmt.ipynb) to check out our detailed explanation of the code design and the results generated by our code. Our best translation outcome (measured by `BLEU` scores) is at: `output > dev.out` and `output > test.out`. For a high level summary of our methods, results, and conclusions, please refer to our [report](report.pdf).

**Topics:** _Natural Language Processing_, _Neural Machine Translation_, _seq2seq Models_, _Attention Mechanism_

**Skills:** _Pytorch_, _Python_, _Jupyter Lab_

## 2. About code prerequisites and functionalities

### Prerequisites: 

Python 3.10.6, Pytorch 1.13.1 + cu 117, torchtext 0.6.0

### Functionalities:

`default.py`: The `default solution` with broken attention mechanism.

`neuralmt_baseline.py`: The `baseline method` (fixed the attention mechanism in the default solution).

`neuralmt_beam_search.py`: `Beam search method`. Replace greedy decoding in the baseline method with beam search.

`neuralmt_beam_search_with_replication_removal.py`: Add the `post processing technique`, `replication removal`, to the beam search method.

`neuralmt_beam_search_with_replication_removal_with_unk_replacement.py`: Add `replication removal` and `<UNK> replacement` to the beam search method.

`neuralmt_ensemble.py`: Implemented `beam search`, `replication removal`, and `<UNK> replacement`. In the translation process, implemented an `"ensemble" of models` (not ensemble decoding).

`neuralmt_final.py`: The one that produces `the best-so-far results`. Basically, this is `beam search` (width=25) + `replication removal` + `<UNK> replacement`.

`neuralmt.py`: The same to `neuralmt_final.py`

## 3. Results

Here are the `BLEU` scores we obtained by different methods:

![BLEU Scores](/demo/BLEU.png)

Below are the ground truth translation and the translation outcomes obtained by our methods:

![Ground truth](/demo/GT.png)

![Translation](/demo/Translation.png)
